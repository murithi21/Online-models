<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Subject Selector</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background-color: #f9f9fb;
      padding: 20px;
      color: #333;
    }

    h2 {
      text-align: center;
      color: #2a7ae2;
      margin-bottom: 20px;
    }

    .main-pathways {
      display: flex;
      flex-wrap: nowrap;
      gap: 20px;
      overflow-x: auto;
      margin-bottom: 30px;
    }

    .pathway {
      flex: 1 1 0;
      background: #fff;
      border-top: 5px solid #2a7ae2;
      border-radius: 6px;
      padding: 15px;
      min-width: 320px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    .pathway h3 {
      text-align: center;
      color: #2a7ae2;
      margin-bottom: 15px;
    }

    .track-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
    }

    .track {
      background-color: #f3f7ff;
      border-radius: 6px;
      padding: 10px;
      min-width: 140px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    .track strong {
      display: block;
      margin-bottom: 6px;
      font-size: 14px;
      color: #1d4ed8;
      text-align: center;
    }

    .subject-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .subject-list li {
      margin-bottom: 5px;
    }

    label {
      font-size: 13px;
      background: #fefefe;
      padding: 3px 6px;
      border-radius: 4px;
      display: inline-block;
      cursor: pointer;
    }

    input[type="checkbox"] {
      margin-right: 5px;
    }

    .search, .actions {
      text-align: center;
      margin: 20px 0;
    }

    input[type="text"] {
      padding: 8px;
      width: 60%;
      max-width: 300px;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-right: 6px;
      font-size: 14px;
    }

    button {
      padding: 8px 14px;
      font-size: 14px;
      background-color: #2a7ae2;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #1f64c8;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: #fff;
      border-radius: 5px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.05);
      font-size: 13px;
    }

    th, td {
      padding: 10px;
      border-bottom: 1px solid #eee;
    }

    th {
      background: #eef2f7;
    }

    tr:hover {
      background-color: #f5faff;
    }

    #selectedSubjects {
      margin-top: 20px;
      font-size: 14px;
    }

    .highlight {
      background-color: #ffffcc !important;
    }

    .track-row {
  display: flex;
  flex-wrap: wrap; /* Allow wrapping if needed */
  gap: 10px;
  justify-content: center;
}

.track {
  background-color: #f3f7ff;
  border-radius: 6px;
  padding: 8px;
  min-width: 150px;
  max-width: 180px;
  word-break: break-word;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  flex: 1 1 150px;
}

.track strong {
  display: block;
  margin-bottom: 4px;
  font-size: 13px;
  color: #1d4ed8;
  text-align: center;
  word-break: break-word;
}

.subject-list {
  list-style: none;
  padding: 0;
  margin: 0;
  font-size: 12px;
}

label {
  font-size: 12px;
  padding: 2px 5px;
  border-radius: 3px;
  word-break: break-word;
}


    @media (max-width: 768px) {
      .main-pathways {
        flex-direction: column;
      }

      .track-row {
        justify-content: flex-start;
      }

      input[type="text"], button {
        width: 100%;
        margin-top: 10px;
      }
    }
  </style>
</head>
<body>
  <h2><img src="../statics/img/logo.png" alt="App Icon" style="width:50px; height:50px; margin-right: 1%; margin-bottom: -1%;">Select Learning Areas</h2>

  <div class="search">
    <input type="text" id="searchInput" placeholder="Search subject..." />
    <button onclick="highlightSearch()">Search</button>
  </div>

  <div class="main-pathways" id="pathwayContainer"></div>

  <div class="actions">
    <button onclick="processSelections()">Process</button>
    <button onclick="printResults()">Print PDF</button>
  </div>

  <div id="selectedSubjects"></div>
  <div id="results"></div>

  <!-- External combinations file -->
  <script src="../statics/combinations_with_clusters.js"></script>

  <script>
    const groupedStructure = {
      "STEM": {
        "Pure Sciences": ["Advanced Mathematics", "General Science", "Biology", "Chemistry", "Physics"],
        "Applied Sciences": ["Computer Studies", "Agriculture", "Home Science"],
        "Technical Studies": ["Electricity", "Woodwork", "Metalwork", "Building Construction", "Power Mechanics", "Aviation", "Media Technology", "Marine & Fisheries"]
      },
      "Social Sciences": {
        "Humanities": ["History & Citizenship", "Geography", "Christian Religious Education", "Islamic Religious Education", "Hindu Religious Education"],
        "Languages": ["English", "Literature in English", "Kiswahili", "Fasihi ya Kiswahili", "French", "German", "Mandarine Chinese", "Arabic", "Indigenous Language", "Kenya Sign Language"]
      },
      "Arts & Sports": {
        "Arts": ["Fine Arts", "Music & Dance", "Theatre & Film"],
        "Sport Science": ["Physical Education", "Sports & Recreation"]
      }
    };

    function renderGroupedTracks() {
      const container = document.getElementById("pathwayContainer");

      for (const [pathway, tracks] of Object.entries(groupedStructure)) {
        const pathwayDiv = document.createElement("div");
        pathwayDiv.className = "pathway";

        let trackRow = '<div class="track-row">';
        for (const [trackName, subjects] of Object.entries(tracks)) {
          trackRow += `
            <div class="track">
              <strong>${trackName}</strong>
              <ul class="subject-list">
                ${subjects.map(subject => `
                  <li><label><input type="checkbox" value="${subject}">${subject}</label></li>
                `).join('')}
              </ul>
            </div>
          `;
        }
        trackRow += '</div>';

        pathwayDiv.innerHTML = `<h3>${pathway}</h3>${trackRow}`;
        container.appendChild(pathwayDiv);
      }
    }

    function highlightSearch() {
      const term = document.getElementById('searchInput').value.toLowerCase();
      const labels = document.querySelectorAll('label');
      labels.forEach(label => {
        const text = label.textContent.toLowerCase();
        label.style.backgroundColor = term && text.includes(term) ? "#ffffcc" : "#fefefe";
      });
    }

    function processSelections() {
      const checked = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
      const selectedDiv = document.getElementById('selectedSubjects');
      selectedDiv.innerHTML = checked.length
        ? `<h3>Selected Learning Areas (${checked.length})</h3><p style="padding: 8px; background-color: #eef9ff; border-left: 3px solid #2a7ae2;">${checked.join(', ')}</p>`
        : "<p><em>No subjects selected.</em></p>";

      const results = subjectCombinations.filter(combo =>
        combo.subjects.every(subject => checked.includes(subject))
      );

      const resultDiv = document.getElementById('results');
      if (results.length === 0) {
        resultDiv.innerHTML = "<p><strong>No matching combinations found.</strong></p>";
        return;
      }

      let html = `<h3>Matching Combinations (${results.length})</h3><table><thead><tr><th>Code</th><th>Subjects</th></tr></thead><tbody>`;
      results.forEach(c => {
        html += `<tr id="row-${c.code}"><td><a href="#" onclick="showCluster('${c.code}', '${c.cluster}')">${c.code}</a></td><td>${c.subjects.join(', ')}</td></tr>`;
      });
      html += "</tbody></table>";
      resultDiv.innerHTML = html;
    }

    function printResults() {
      const content = document.getElementById('results').innerHTML;
      const w = window.open('', '', 'height=800,width=1000');
      w.document.write('<html><head><title>Printable Subject Combinations</title></head><body>');
      w.document.write(content);
      w.document.write('</body></html>');
      w.document.close();
      w.print();
    }

    renderGroupedTracks();

    const clusterDescriptions = {
  "Health Sciences": "Careers in medicine, nursing, pharmacy, and public health.",
  "Science, Technology, Engineering and Mathematics (STEM)": "Careers in science, engineering, data analysis, and technology.",
  "Information and Communication Technology (ICT)": "Careers in programming, networking, digital communication, and AI.",
  "Creative Arts and Entertainment": "Careers in performing, visual arts, design, and film.",
  "Business, Finance and Entrepreneurship": "Careers in business, finance, trade, and entrepreneurship.",
  "Marine and Blue Economy": "Careers related to oceans, fishing, marine transport, and sustainability.",
  "Construction and Built Environment": "Careers in architecture, building, construction and civil engineering.",
  "Sports Science and Physical Education": "Careers in sports science, athletics, fitness and recreation.",
  "Law, Governance and Security": "Careers in law, justice, policy, diplomacy, and governance.",
  "Energy and Power": "Careers in electrical engineering, renewable energy and aviation tech.",
  "Agriculture, Food and Natural Resources": "Careers in farming, environmental science and food security.",
  "Hospitality, Tourism and Foreign Languages": "Careers in travel, culture, languages, and culinary services.",
  "General Multidisciplinary": "Combinations that support diverse fields across sectors."
};

function showCluster(code, clusterName) {
  const rowId = `row-${code}`;
  const insertId = `cluster-${code}`;
  const existing = document.getElementById(insertId);

  if (existing) {
    existing.remove(); // Toggle off
    return;
  }

  const row = document.getElementById(rowId);
  const tr = document.createElement("tr");
  tr.id = insertId;

  const td = document.createElement("td");
  td.colSpan = 2;

  const desc = clusterDescriptions[clusterName] || "No description available.";
  td.innerHTML = `
    <div style="margin-top: 5px; padding: 12px; background-color: #fff3cd; border-left: 4px solid #f0ad4e;">
      <h4>Career Cluster Match</h4>
      <p><strong>${clusterName}</strong></p>
      <p style="margin: 0; font-size: 13px;">${desc}</p>
    </div>
  `;

  tr.appendChild(td);
  row.insertAdjacentElement("afterend", tr);
}
  </script>
</body>
</html>
